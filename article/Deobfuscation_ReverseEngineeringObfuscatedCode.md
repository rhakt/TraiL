# Deobfuscation: Reverse Engineering Obfuscated Code

## About

WCRE2015

## Abstract

近年、コードの難読化が注目されている.
プロプライエタリなソフトウェアの内部の動作を、攻撃者に理解しにくくすることで、
低コストでソフトウェアのセキュリティを向上させるというものだ.

この論文では、難読化されたプログラムのリバースエンジニアリングへの第一歩として、
自動でコードの**逆難読化**を行う技術を調査する.

我々の研究では、多くの難読化の効果は静的解析を難しくすることを意図していて、
素直な静的,動的解析の単純な組み合わせで打ち破ることが可能であることを示す.

これは、エンジニアリングとセキュリティの両方に適用できる.

エンジニアリングでは:
リバースエンジニアリングを難しくする設計になっているコードであっても、
いかに動的解析がリバースエンジニアリングで有用であるかを示す

セキュリティでは:
難読化する人に攻撃モデルを提供し、
素直なリバースエンジニアリングに対応できる難読化技術の開発者の助けとなる.


## Introduction

難読化技術のゴールは、リバースエンジニアリングを困難にすること.
攻撃者からの脆弱性の発見を防ぐ.
リバースエンジニアリングをするには、リソースや時間的に高コストであるという点で困難.

難読化は、リバースエンジニアリングを防ぐためだけの技術だけではなく、
マルウェアが、その悪質なコードを隠すためにも利用される.

control flatteningは、研究文献[2,24,25]で提案されている難読化技術で、
Cloakwareの製品でも利用されている.

`control flow flattening`の静的,動的解析の組み合わせによる攻撃への耐性を調べる.


## Obfuscating Transformations

２つのタイプの難読化

1. surface obfuscation

具体的な構文を難読化することに焦点
変数名とか識別子とか

EX) .NETの"Dotfuscator"

2. deep obfuscation

プログラムの実際の構造を難読化
制御フローやデータ参照の動作の変更


前者(surface obfuscation)は、人間が理解することが難しくなるかもしれないが、
プログラムの意味構造を隠すことにはなっていない.
だから、リバースエンジニアリングに用いられるアルゴリズムには影響がない.
(ex. プログラムスライスは、具体的な構文ではなく、コードの構造と意味に依存している.)

Dotfuscatorのようなリネームの殆どの効果は、言語のスコープ規則から名前参照を解決する
パーサーをただ使えば良い.

deep obfuscationは実際の構造を変更する.
意味的側面について推論が必要なので、surfaceより対処が難しい

Chenxi Wangの論文の3つの制御フロー難読化技術について
Cloakwareの商用ソフトでも重要なコンポーネントになっている

### basic control flow flattening


## Deobfuscation

難読化コードに対する有用な変換

### cloning

spurious pathの除去
順方向は逆方向は汚染が消せない.
明らかにコードが増える.
何がspuriousなのかという事前知識なしでできるべき.

クローンするノードの基準は

### static path feasibility analysis

### static and dynamic

## Experimental Evaluation



## Related Work

難読化コードのリバースエンジニアリングの先行研究は知らない.
リバースエンジニアの支援と、コード難読化手法の長所と短所の評価という2つの目的

## Conclusions

コードの難読化は、数多くの研究者によって、
リバースエンジニアリングを困難にするという点で提案されてきた.

難読化変換は一般に、あるプログラムの特性に関する静的な推論理論的難しさに頼っている.
我々の論文では、静的、動的解析の組み合わせによって、いくつかの難読化効果を
回避することができることを示した.

特に、***control flow flattening*** の効果の難読化の問題について調査した.
これは、難読化技術を制御するもので、研究文献で提案されていたり、商用のコード難読化ツールで使われている.

基本的なcontrol flow flatteningは、比較的単純な静的技術で取り除くことができて、
一方、動的技術を利用することでより逆難読化効果を高めることができる.
